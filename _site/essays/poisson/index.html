<!DOCTYPE html><html><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1"><meta name="baidu-site-verification" content="x4U8lzh1X1" /><title>泊松分布的推导 - 游戏暂停</title><link href="https://fonts.googleapis.com/css?family=Lato:900|Work+Sans" rel="stylesheet"><link rel="stylesheet" href="/css/main.css"><title>泊松分布的推导 | 游戏暂停</title><meta name="generator" content="Jekyll v3.7.3" /><meta property="og:title" content="泊松分布的推导" /><meta property="og:locale" content="en_US" /><meta name="description" content="李家伟的博客。" /><meta property="og:description" content="李家伟的博客。" /><link rel="canonical" href="http://localhost:4000/essays/poisson/" /><meta property="og:url" content="http://localhost:4000/essays/poisson/" /><meta property="og:site_name" content="游戏暂停" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2017-04-07T22:00:00+01:00" /><script type="application/ld+json"> {"mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/essays/poisson/"},"description":"李家伟的博客。","@type":"BlogPosting","headline":"泊松分布的推导","dateModified":"2017-04-07T22:00:00+01:00","datePublished":"2017-04-07T22:00:00+01:00","url":"http://localhost:4000/essays/poisson/","@context":"http://schema.org"}</script><script type="text/x-mathjax-config"> MathJax.Hub.Config({ TeX: { equationNumbers: { autoNumber: "AMS" } }, tex2jax: { inlineMath: [ ['$','$'], displayMath: [ ['$$','$$'] ], processEscapes: true, } });</script><script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></head><body style="background-color: rgb(255, 255, 255)"><script src="/js/theme.min.js"></script><header> <a href="/"><div class="home"></div></a></header><h1 class="post-headline">泊松分布的推导</h1><div class="meta"><span> 2017 年 4 月 7 日 </span></div><ul id="markdown-toc"><li><a href="#自然对数-e-的意义" id="markdown-toc-自然对数-e-的意义">自然对数 e 的意义</a></li><li><a href="#二项分布" id="markdown-toc-二项分布">二项分布</a></li><li><a href="#泊松分布的推导" id="markdown-toc-泊松分布的推导">泊松分布的推导</a></li><li><a href="#泊松分布的应用" id="markdown-toc-泊松分布的应用">泊松分布的应用</a></li><li><a href="#参考资料" id="markdown-toc-参考资料">参考资料</a></li></ul><p>QM 课上讲泊松分布 (Poisson Distributions) 竟然只讲了公式，写篇文章聊聊泊松分布的推导。</p><p>泊松分布解决的问题看起来非常简单。比如这个：已知某医院平均一天里有 8 名新生儿诞生，那么医院一个月里，每日新生儿出生数量的分布是怎样的？</p><p>把泊松分布发扬光大的 Bortkiewicz 在《小数法则》一书里举了这么一个例子：从1875到1894年的20年间，德国的十四个军团部有士兵被马踢伤致死的人数纪录。这 20×14 = 280个纪录，按死亡人数来分，如下所示。</p><table> <thead> <tr> <th>每年死亡人數</th> <th>记录数</th> </tr> </thead> <tbody> <tr><td>0</td><td>144</td></tr> <tr><td>1</td><td>91</td></tr> <tr><td>2</td><td>32</td></tr> <tr><td>3</td><td>11</td></tr> <tr><td>4</td><td>2</td></tr> <tr><td>≥5</td><td>0</td></tr> </tbody> </table><p>这280个记录中，共有196人死亡，死亡率是 0.7，根据这一数据，Bortkiewicz 用泊松分布计算得出结果，如下所示，可以看到泊松分布得出的结果和现实出奇地吻合。</p><table> <thead> <tr> <th>每年死亡人數</th> <th>记录数</th> <th>泊松分布</th> </tr> </thead> <tbody> <tr><td>0</td><td>144</td><td>139.0</td></tr> <tr><td>1</td><td>91</td><td>97.3</td></tr> <tr><td>2</td><td>32</td><td>34.1</td></tr> <tr><td>3</td><td>11</td><td>8.0</td></tr> <tr><td>4</td><td>2</td><td>1.4</td></tr> <tr><td>≥5</td><td>0</td><td>0.2</td></tr> </tbody> </table><p>泊松分布其实只是二项式分布的极限情况，泊松分布公式如下：</p><script type="math/tex; mode=display">P(N(t) = n) = \frac{(\lambda t)^n e^{-\lambda t}}{n!}</script><p>它的推导非常简单，但在推导之前，我们必须了解自然对数 e 的意义。</p><h2 id="自然对数-e-的意义">自然对数 e 的意义</h2><p>我们就从简单的存钱问题入手。</p><p>你向银行存了 100 元，年利率是 100%，到下一年的此时，你就能取出 200 元。</p><p>现在银行允许你半年就能取出利息，年利率还是 100%，但半年后，你就能取出年利息的一半，也就是 50%，50 元。半年后，你决定把取出的五十块钱利息立即存进银行里，又过了半年后（第一存款的一年后），你的存款就是<script type="math/tex">100×(1+\frac{100\%} {2})^2 = 225</script></p><p>现在银行允许你一个月就能取出利息，年利率还是 100%。你 1 月存了 100 元，1月结束，你取出利息后立即存到银行里，2月结束你取出利息后又存进去… 这样一年后，你的存款是<script type="math/tex">100×(1+\frac{100\%} {12}) ^{12} = 261.303529</script></p><p>现在银行允许你一天就能取出利息，一年后你的存款是<script type="math/tex">100\times(1+\frac{100\%} {365}) ^{365} = 271.4567482</script></p><p>现在我们考虑更极限的情况，银行允许你一小时就能取出利息。一年后你的存款是<script type="math/tex">100\times(1+\frac{100\%} {365\times24}) ^{365\times24} = 271.8126692</script></p><p>可以发现，当我们取的时间越来越小时，也就是 n 无限大时，存款逐渐逼近某个数，这个数就是<script type="math/tex">100\times(1+\frac{100\%} { n}) ^{n}=100e≈274.8281828</script></p><p>因此，你可以把 e 理解为极限情况下，100% 年利率下，利滚利能取得的最高收益。</p><p>但如果年利率是 10%呢？极限情况（n 是个无限大的数）下，一年后你的存款是<script type="math/tex">100\times(1+\frac{10\%} { n}) ^{n} = 100\times(1+\frac{100\%} {10n}) ^{n} = 100\times[(1+\frac{100\%} {10n}) ^{10n}]^{\frac{1} {10}} = 100e^{\frac{1} {10}}</script></p><p>再将公式推广，本钱是1，年利率（增长率）是 a，n 无限大时，t 年后的存款是<script type="math/tex">1\times(1+\frac{a} { n}) ^{tn} = 1\times(1+\frac{1} {\frac{n} {a}}) ^{tn} = 1\times[(1+\frac{1} {\frac{n} {a}}) ^{\frac{n} {a}}]^{ta} = e^{ta}</script></p><p>泊松分布是二项分布的极限情况，我们现在来看一下二项分布的性质。</p><h2 id="二项分布">二项分布</h2><p>在一个无限空间口袋里，有无限多的黑球和白球，40%是黑球，60%是白球。分别拿三次球并记录每次拿出球的颜色，其中1个是白球，剩下2个是黑球的概率 P 是多少？</p><p>首先拿三次球一白二黑，有三种排列组合的情况，白黑黑，黑白黑，黑黑白。</p><p>拿出白黑黑的概率是，0.6×0.4×0.4=0.096</p><p>拿出黑白黑的概率是，0.4×0.6×0.4=0.096</p><p>拿出黑黑白的概率是，0.4×0.4×0.6=0.096</p><p>因此，P = 0.096 + 0.096 + 0.096 = 0.288</p><p>以上就是二项分布了，二项分布的公式很好理解，P = 排列组合的数量 × 该组合的概率</p><p>求排列组合的数量可以这么想。事件总数（size）是 n，事件分成2种情况，S 是白方块，数量为 k，F 是黑方块，数量就是 n-k。现在我们把所有白方块和黑方块都看做不同的，也就是 S1, S2, S3… Sk, F1, F2, F3… Fn-k，让这些方块排列组合，组合数量就是 n!。</p><p><img src="https://ww4.sinaimg.cn/large/006tKfTcgy1fegwndlftnj30mw0fmaat.jpg" alt="" /></p><p>但如果我们把黑色的方块视为相同的，白色还是不同的，每种排列都有 (n-k)! 个重复情况，如下图所示。</p><p><img src="https://ww3.sinaimg.cn/large/006tKfTcgy1fegwneipnxj30mw0fmaat.jpg" alt="" /></p><p>如果我们把白色的方块视为相同的，每种排列会有 k! 个重复情况。</p><p>因此当所有黑方块和白方块视为相同时，组合数量为 n! / [(n-k)! × k!)]</p><p>p 为成功概率，(1-p) 就是失败的概率，事件总数为 n，成功次数为 k，失败次数就是 n-k，不考虑顺序（也就是同时发生）该组合的概率就是<script type="math/tex">p^{k}(1-p)^{n-k}</script></p><p>若考虑顺序，概率 P 就是</p><script type="math/tex; mode=display">\frac {n!} {(n-k)! × k!} \times p^{k}(1-p)^{n-k}</script><h2 id="泊松分布的推导">泊松分布的推导</h2><p>泊松分布就是二项分布的极限情况。</p><p>已知某医院平均一天里有 λ 名新生儿诞生，我们可以把这一天以每秒计算，一天有86400秒，我们把出生瞬间定义为婴儿刚刚离开阴道的时间，假设新生儿不可能在同一秒出生，且每秒婴儿出生的概率相同，均为 λ/86400。</p><p>这就是二项分布问题，一天里的事件总数 n = 86400，成功概率 p = λ/86400=，失败概率 1-p = 1-λ/86400，带入公式，每日出生 k 名婴儿的概率就是</p><script type="math/tex; mode=display">\frac {86400!} {(86400-k)! × k!} \times (\frac{\lambda}{86400})^{k}(1-\frac{\lambda}{86400})^{86400-k}</script><p>但我们是不是也能把这一秒再分割呢？比如毫秒、微秒？这样我们就更能保证在一微秒不会有多名婴儿同时诞生，我们把事件总数 n 看作无限大，每日出生 k 名婴儿的概率就是</p><script type="math/tex; mode=display">\frac {n!} {(n-k)! × k!} \times (\frac{\lambda}{n})^{k}(1-\frac{\lambda}{n})^{n-k} \\\ =\frac {n(n-1)(n-2)...(n-k+1)} {n^{k}}\lambda^{k}\frac{1}{k!}(1-\frac{\lambda}{n})^{n-k} \\\ =1(1-\frac{1}{n})(1-\frac{2}{n})...(1-\frac{k-1}{n})\lambda^{k}\frac{1}{k!}(1-\frac{\lambda}{n})^{n-k} \\\ =1(1-\frac{1}{n})(1-\frac{2}{n})...(1-\frac{k-1}{n})\lambda^{k}\frac{1}{k!}\frac{(1-\frac{\lambda}{n})^{n}}{(1-\frac{\lambda}{n})^{k}}</script><p>因为此时 n 无限大，k 和 λ 相对小，结合自然对数 e 的性质，可以做以下的近似</p><script type="math/tex; mode=display">1(1-\frac{1}{n})(1-\frac{2}{n})...(1-\frac{k-1}{n})\rightarrow1 \\\ (1-\frac{\lambda}{n})^{k}\rightarrow1^{k}\rightarrow1 \\\ (1-\frac{\lambda}{n})^{n} = (1+\frac{-\lambda}{n})^{n}\rightarrow e^{-\lambda}</script><p>因此</p><script type="math/tex; mode=display">=1(1-\frac{1}{n})(1-\frac{2}{n})...(1-\frac{k-1}{n})\lambda^{k}\frac{1}{k!}\frac{(1-\frac{\lambda}{n})^{n}}{(1-\frac{\lambda}{n})^{k}}≈1\times\lambda^{k}\frac{1}{k!}\frac{e^{-\lambda}}{1}=\frac{\lambda^{k}e^{-\lambda}}{k!}</script><h2 id="泊松分布的应用">泊松分布的应用</h2><p>已知某医院平均一天里有 8 名新生儿诞生，那么医院一个月里，每日新生儿出生数量的分布是怎样的？</p><p>用刚刚推出的公式，已知 λ =8，我们可以分别计算出每日诞生 1 名、2 名、3 名… 婴儿的概率。</p><p>用 Python 写了个循环，代码如下：</p><pre><code class="language-Python">import math
import numpy as np

for k in range(1,30):
    l = 8.
    p = l ** k * np.exp(-l) / math.factorial(k)
    print '每日诞生 %d 名婴儿的概率 p = %f' %(k,p)

#部分输出如下
每日诞生 6 名婴儿的概率 p = 0.122138
每日诞生 7 名婴儿的概率 p = 0.139587
每日诞生 8 名婴儿的概率 p = 0.139587
每日诞生 9 名婴儿的概率 p = 0.124077
每日诞生 10 名婴儿的概率 p = 0.099262
每日诞生 11 名婴儿的概率 p = 0.072190
每日诞生 12 名婴儿的概率 p = 0.048127
每日诞生 13 名婴儿的概率 p = 0.029616
每日诞生 14 名婴儿的概率 p = 0.016924
</code></pre><p>用图像表示概率分布如下：</p><p><img src="https://ww2.sinaimg.cn/large/006tKfTcgy1fegwnhsx98j30dj095q2v.jpg" alt="" /></p><h2 id="参考资料">参考资料</h2><p><a href="http://episte.math.ntu.edu.tw/articles/sm/sm_16_07_1/index.html">Poisson 分布</a></p><p><a href="http://www.ruanyifeng.com/blog/2011/07/mathematical_constant_e.html">e 的含义</a></p><footer><div class="links"> <a href="/about/">About</a> <a href="/contact/">Contact</a> <a href="https://github.com/iewaij">Github</a> <a href="https://twitter.com/tiewuz">Twitter</a> <a href="/feed.xml">RSS</a></div></footer><script> (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','//www.google-analytics.com/analytics.js','ga'); ga('create', 'UA-92264874-1', 'auto'); ga('send', 'pageview');</script></body></html>
